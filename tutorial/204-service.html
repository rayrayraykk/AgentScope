<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Enhancing Agent Capabilities with Service Functions &mdash; AgentScope  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Memory and Message Management" href="205-memory.html" />
    <link rel="prev" title="Using Different Model Sources with Model API" href="203-model.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            AgentScope
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">AgentScope Tutorial</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="advance.html">Advanced Exploration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="201-agent.html">Customizing Your Own Agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="202-pipeline.html">Agent Interactions: Dive deeper into Pipelines and Message Hub</a></li>
<li class="toctree-l2"><a class="reference internal" href="203-model.html">Using Different Model Sources with Model API</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Enhancing Agent Capabilities with Service Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#serviceresponse">ServiceResponse</a></li>
<li class="toctree-l3"><a class="reference internal" href="#overview-of-service-functions">Overview of Service Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usage">Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="205-memory.html">Memory and Message Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="206-prompt.html">Prompt Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="207-monitor.html">Monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="208-distribute.html">Make Your Applications Distributed</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">Get Involved</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AgentScope API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../agentscope.agents.html">Agents package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agentscope.memory.html">Memory package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agentscope.models.html">Models package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agentscope.pipelines.html">Pipelines package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agentscope.service.html">Service package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agentscope.rpc.html">RPC package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agentscope.utils.html">Utils package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agentscope.web.html">Web UI package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agentscope.html">Module contents</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AgentScope</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="advance.html">Advanced Exploration</a></li>
      <li class="breadcrumb-item active">Enhancing Agent Capabilities with Service Functions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorial/204-service.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="enhancing-agent-capabilities-with-service-functions">
<span id="service"></span><h1>Enhancing Agent Capabilities with Service Functions<a class="headerlink" href="#enhancing-agent-capabilities-with-service-functions" title="Link to this heading"></a></h1>
<p><strong>Service functions</strong>, often referred to simply as <strong>Service</strong>, constitute a versatile suite of utility tools that can be used to enhance the functionality of agents. A service is designed to perform a specific task like web search, code interpretation, or file processing. Services can be invoked by agents and other components for reuse across different scenarios.</p>
<section id="serviceresponse">
<h2>ServiceResponse<a class="headerlink" href="#serviceresponse" title="Link to this heading"></a></h2>
<p>The design behind <code class="docutils literal notranslate"><span class="pre">Service</span></code> distinguishes them from typical Python functions. In scenarios where execution is failed, service functions do not raise exceptions within the program. Instead, they return a <code class="docutils literal notranslate"><span class="pre">ServiceResponse</span></code> (a sub-class of dict).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">demo_service</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">ServiceResponse</span><span class="p">:</span>
    <span class="c1">#do some specifc actions</span>
    <span class="c1"># ......</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">ServiceResponse</span><span class="p">({</span><span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">res</span>


<span class="k">class</span> <span class="nc">ServiceResponse</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Used to wrap the execution results of the services&quot;&quot;&quot;</span>
    <span class="c1"># ... [code omitted for brevity]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">status</span><span class="p">:</span> <span class="n">ServiceExecStatus</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">status</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span>
</pre></div>
</div>
<p>This object encapsulates <code class="docutils literal notranslate"><span class="pre">status</span></code> of the execution (<code class="docutils literal notranslate"><span class="pre">SUCCESS</span></code> or <code class="docutils literal notranslate"><span class="pre">ERROR</span></code>), which can indicate success or failure, and the <code class="docutils literal notranslate"><span class="pre">content</span></code>, which can either be the output of a successful execution or the error stack from a failure.</p>
<p>Here’s why this design is beneficial:</p>
<ul class="simple">
<li><p><strong>Error Handling</strong>: <code class="docutils literal notranslate"><span class="pre">Service</span></code> and <code class="docutils literal notranslate"><span class="pre">ServiceResponse</span></code> allows agents to flexibly handle errors. An agent can check the status of the response and decide on the next steps, whether to retry the operation, use fallback logic, or analyze the error stack and choose an appropriate strategy to make improvements.</p></li>
<li><p><strong>Consistency</strong>: Service functions provide a consistent interface for both successful outcomes and errors. This consistency simplifies the interaction model for agents that use these services.</p></li>
</ul>
</section>
<section id="overview-of-service-functions">
<h2>Overview of Service Functions<a class="headerlink" href="#overview-of-service-functions" title="Link to this heading"></a></h2>
<p>Below is a table outlining various service functions categorized by their primary domain. These services offer a range of capabilities to agents.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Service Scenario</p></th>
<th class="head"><p>Service Function Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Code</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">execute_python_code</span></code></p></td>
<td><p>Execute a string of Python code, optionally inside a Docker container.</p></td>
</tr>
<tr class="row-odd"><td><p>Retrieval</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">retrieve_from_list</span></code></p></td>
<td><p>Retrieve specific items from a list based on given criteria.</p></td>
</tr>
<tr class="row-even"><td><p>SQL Query</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">query_mysql</span></code></p></td>
<td><p>Execute a SQL query against a MySQL database and return results.</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">query_sqlite</span></code></p></td>
<td><p>Execute a SQL query against a SQLite database and return results.</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">query_mongodb</span></code></p></td>
<td><p>Perform a query or operation against a MongoDB collection.</p></td>
</tr>
<tr class="row-odd"><td><p>Text Processing</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">summarization</span></code></p></td>
<td><p>Summarize a block of text to highlight the main points with LLM.</p></td>
</tr>
<tr class="row-even"><td><p>Web Search</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">web_search</span></code></p></td>
<td><p>Perform a web search using a specified search engine (currently supports Google and Bing).</p></td>
</tr>
<tr class="row-odd"><td><p>File</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">create_file</span></code></p></td>
<td><p>Create a new file at a specified path with optional initial content.</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">delete_file</span></code></p></td>
<td><p>Delete a file specified by the file path.</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">move_file</span></code></p></td>
<td><p>Move or rename a file from one path to another.</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">create_directory</span></code></p></td>
<td><p>Create a new directory at a specified path.</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">delete_directory</span></code></p></td>
<td><p>Delete a directory and all of its contents.</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">move_directory</span></code></p></td>
<td><p>Move or rename a directory from one path to another.</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">read_text_file</span></code></p></td>
<td><p>Read and return the contents of a text file.</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">write_text_file</span></code></p></td>
<td><p>Write text content to a file at a specified path.</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">read_json_file</span></code></p></td>
<td><p>Read and parse the contents of a JSON file.</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">write_json_file</span></code></p></td>
<td><p>Serialize a Python object to JSON and write it to a file.</p></td>
</tr>
<tr class="row-odd"><td><p><em>More to Come</em></p></td>
<td><p></p></td>
<td><p>Additional service functions are being developed and will be added to enhance the capabilities of AgentScope further.</p></td>
</tr>
</tbody>
</table>
<p>For details about each Service Function, please consult the API references, where the docstrings provide comprehensive information about the parameters, expected input formats, return types, and any additional options that can modify the behavior of the Service Function.</p>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading"></a></h2>
<p>In AgentScope, each Service Function comes with a meticulously crafted docstring and demonstrative test functions that provide detailed instructions on how to utilize it. To enhance the capabilities of your agents with these services, you can craft prompts for LLM to generate parameters for Service:</p>
<p>By composing appropriate prompts that align with the information detailed in the Service Functions’ docstrings, you can guide an LLM to generate responses that match the required parameters of a <code class="docutils literal notranslate"><span class="pre">Service</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">from</span> <span class="nn">agentscope.service</span> <span class="kn">import</span> <span class="n">ServiceResponse</span>
<span class="kn">from</span> <span class="nn">agentscope.agents</span> <span class="kn">import</span> <span class="n">AgentBase</span>


<span class="k">def</span> <span class="nf">create_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ServiceResponse</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a file and write content to it.</span>

<span class="sd">    Args:</span>
<span class="sd">        file_path (str): The path where the file will be created.</span>
<span class="sd">        content (str): Content to write into the file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ServiceResponse: where the boolean indicates success, and the</span>
<span class="sd">        str contains an error message if any, including the error type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># ... [code omitted for brevity]</span>


<span class="k">class</span> <span class="nc">YourAgent</span><span class="p">(</span><span class="n">AgentBase</span><span class="p">):</span>
    <span class="c1"># ... [code omitted for brevity]</span>

    <span class="k">def</span> <span class="nf">reply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="c1"># ... [code omitted for brevity]</span>

        <span class="c1"># Construct the prompt for the agent to provide parameters in JSON</span>
        <span class="c1"># format</span>
        <span class="n">prompt</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;To complete the user request</span><span class="se">\n</span><span class="s2">```</span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">```</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Please provide the necessary parameters in JSON format for the &quot;</span>
            <span class="s2">&quot;function:</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Function: </span><span class="si">{</span><span class="n">create_file</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Description: Create a file and write content to it.</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Add details about the function parameters</span>
        <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">create_file</span><span class="p">)</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="n">params_prompt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">param</span><span class="o">.</span><span class="n">annotation</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">): &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;(default: &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">default</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="k">if</span><span class="w"> </span><span class="n">param</span><span class="o">.</span><span class="n">default</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="o">.</span><span class="n">empty</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">parameters</span>
        <span class="p">)</span>
        <span class="n">prompt</span> <span class="o">+=</span> <span class="n">params_prompt</span>

        <span class="c1"># Get the model response</span>
        <span class="n">model_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

        <span class="c1"># Parse the model response and call the create_file function</span>
        <span class="c1"># Additional extraction functions might be necessary</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">model_response</span><span class="p">)</span>
            <span class="n">create_file</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c1"># Error handling</span>
            <span class="k">pass</span>

        <span class="c1"># ... [code omitted for brevity]</span>
</pre></div>
</div>
<p><a class="reference internal" href="#enhancing-agent-capabilities-with-service-functions"><span class="xref myst">[Return to the top]</span></a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="203-model.html" class="btn btn-neutral float-left" title="Using Different Model Sources with Model API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="205-memory.html" class="btn btn-neutral float-right" title="Memory and Message Management" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Alibaba Tongyi Lab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>